(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{295:function(e,t,o){"use strict";o.r(t);var v=o(38),l=Object(v.a)({},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"uitableviewcell-高度估算"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#uitableviewcell-高度估算","aria-hidden":"true"}},[e._v("#")]),e._v(" UITableViewCell 高度估算")]),e._v(" "),o("blockquote",[o("p",[e._v("设备：iPhone XS Max, 系统：iOS 13.3")])]),e._v(" "),o("p"),o("div",{staticClass:"table-of-contents"},[o("ul")]),o("p"),e._v(" "),o("p",[e._v("UITableView 自 iOS7.0开始，便默认开启 cell 高度估算机制，若想禁用，将属性"),o("code",[e._v("estimatedRowHeight")]),e._v("设为0即可。")]),e._v(" "),o("p",[e._v("我们知道，如果 tableView 包含可变 cell 高度，加载 tableView 时，计算高度将会非常耗性能。而高度估算机制的出现，可以将这些耗时的计算从 tableView 加载时推迟到滚动时，从而提高了 tableView 的加载性能。")]),e._v(" "),o("p",[e._v("若关闭高度估算机制，每次调用"),o("code",[e._v("reloadData")]),e._v("时：")]),e._v(" "),o("ul",[o("li",[e._v("首先会调用多次"),o("code",[e._v("heightForRowAtIndexPath:")]),e._v("（调用次数为 cell 总个数，即 numberOfSections * numberOfRows），从而确定"),o("code",[e._v("contentSize")]),e._v("；")]),e._v(" "),o("li",[e._v("其次，会调用"),o("code",[e._v("cellForRow")]),e._v("以及再次调用"),o("code",[e._v("heightForRowAtIndexPath:")]),e._v("（调用次数为当前屏幕需要展示的 cell 个数）。")])]),e._v(" "),o("p",[e._v("然而，如果开启高度计算时，系统并不会预先调用多次"),o("code",[e._v("heightForRowAtIndexPath:")]),e._v("，而是在调用完"),o("code",[e._v("cellForRow")]),e._v("后，紧接着调用"),o("code",[e._v("heightForRowAtIndexPath:")]),e._v("来确定"),o("code",[e._v("contentSize")]),e._v("。")]),e._v(" "),o("p",[e._v("当 tableView 首次出现在屏幕上时，系统只会调用 m 次 "),o("code",[e._v("cellForRow")]),e._v("和"),o("code",[e._v("heightForRowAtIndexPath:")]),e._v("，之后，再在滚动过程中，不断的修正"),o("code",[e._v("contentSize")]),e._v("大小。")]),e._v(" "),o("p",[e._v("而这个次数 m 计算如下：")]),e._v(" "),o("div",{staticClass:"tip custom-block"},[o("p",[e._v("m = tableViewHeight / estimatedRowHeight. (number of rows >= m >= visible rows)")])])])},[],!1,null,null,null);t.default=l.exports}}]);