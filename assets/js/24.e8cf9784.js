(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{289:function(s,t,n){"use strict";n.r(t);var a=n(38),e=Object(a.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"nsexception"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nsexception","aria-hidden":"true"}},[s._v("#")]),s._v(" NSException")]),s._v(" "),n("ul",[n("li",[n("h3",{attrs:{id:"throw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#throw","aria-hidden":"true"}},[s._v("#")]),s._v(" @throw")])])]),s._v(" "),n("p",[s._v("一旦程序检测到异常，就必须得将它传递到处理它的代码，这段代码被称为异常处理程序。而异常传递的整个过程被称为抛出异常(throwing an exception)，或者叫引发异常(raising an exception)。")]),s._v(" "),n("p",[s._v("示例代码：")]),s._v(" "),n("div",{staticClass:"language-objectivec line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objectivec"}},[n("code",[s._v("NSException "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("exception "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NSException exceptionWithName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"FileNotFoundException"')]),s._v(" reason"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"File Not Found on System"')]),s._v(" userInfo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("nil"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@throw")]),s._v(" exception"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// [exception raise]; // 等价于@throw exception")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("然而"),n("code",[s._v("@throw")]),s._v("和"),n("code",[s._v("raise")]),s._v("并不是完全等价的，一个重要的区别就是"),n("code",[s._v("raise")]),s._v("方法的调用者只能是"),n("code",[s._v("NSException")]),s._v("对象，而"),n("code",[s._v("@throw")]),s._v("的参数不仅可以是"),n("code",[s._v("NSException")]),s._v("对象，还可以是其他类型的对象(比如字符串对象)，但是在"),n("a",{attrs:{href:"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CocoaFundamentals/WhatIsCocoa/WhatIsCocoa.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Cocoa 应用程序"),n("OutboundLink")],1),s._v("中，应该只使用"),n("code",[s._v("NSException")]),s._v("对象。")]),s._v(" "),n("ul",[n("li",[n("h3",{attrs:{id:"try-catch-finally"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#try-catch-finally","aria-hidden":"true"}},[s._v("#")]),s._v(" @try-@catch-@finally")])])]),s._v(" "),n("p",[s._v("既然有异常，那么我们就需要捕获并处理它。通过"),n("code",[s._v("@try-@catch")]),s._v("来捕获异常，可以避免应用程序Crash。")]),s._v(" "),n("div",{staticClass:"language-objectivec line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objectivec"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里是可能会引发异常的代码，比如：数组越界、往数组中插入nil、使用KVC等")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里是处理@try中抛出的异常的代码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 无论是否抛出异常，这里都会执行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("异常处理程序也可以进行嵌套，最里层抛出的异常由它的外层进行catch，而最外层抛出的异常由于没有handler进行catch，则会进入到顶层的错误处理函数，以便在App闪退之前可以做些日志记录等相关操作。")]),s._v(" "),n("p",[s._v("一图以蔽之：")]),s._v(" "),n("center",[n("img",{staticStyle:{"border-radius":"3px","box-shadow":"0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08)"},attrs:{src:"/resources/exception.jpeg"}}),s._v(" "),n("br"),s._v(" "),n("div",{staticStyle:{color:"#999","border-bottom":"1px solid #d9d9d9",display:"inline-block",padding:"2px"}},[s._v("图取自Apple文档")])]),s._v(" "),n("p",[s._v("demo代码如下：")]),s._v(" "),n("div",{staticClass:"language-objectivec line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-objectivec"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("myUncaughtExceptionHandler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NSException "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("exception"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"uncaught exception is %@"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" exception"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 未捕获的异常")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("viewDidLoad "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("super")]),s._v(" viewDidLoad"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSSetUncaughtExceptionHandler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("myUncaughtExceptionHandler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),s._v(" doMethod1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("doMethod1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> try1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),s._v(" doMethod2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NSException "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("exception"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> catch1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@throw")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> finally1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("doMethod2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> try2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),s._v(" doMethod3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NSException "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("exception"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> catch2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@throw")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> finally2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("doMethod3 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> try3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@throw")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NSException exceptionWithName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"TestExceptionName"')]),s._v(" reason"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"throw an exception"')]),s._v(" userInfo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("nil"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NSException "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("exception"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> catch3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@throw")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("@finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("NSLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('@"--\x3e> finally3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br")])]),n("hr"),s._v(" "),n("p",[s._v("虽然"),n("code",[s._v("@try-@catch")]),s._v("能捕获异常避免crash，但是在日常开发中却很少使用。一方面，源于"),n("a",{attrs:{href:"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Exceptions/Tasks/HandlingExceptions.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Apple文档"),n("OutboundLink")],1),s._v("所说的内存管理方面的问题；另一方面，个人认为"),n("code",[s._v("@try-@catch")]),s._v("能够捕获的异常基本上都是我们应用层能够预料得到的或者说能够避免的。拿数组越界来举例，苹果会在底层实现判断是否会越界，如果没有越界就正常取值，反之生成一个exception对象并向外抛出。 通过汇编我们能看到一些蛛丝马迹：")]),s._v(" "),n("div",{staticClass:"language-wasm line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-wasm"}},[n("code",[s._v("CoreFoundation`-[__NSSingleObjectArrayI objectAtIndex:]:\n->  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebef0")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+0")]),s._v(">:   cbnz   x2, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf04")]),s._v("   ;通过比较x2中的值是否为"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("来判断是否越界\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebef4")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+4")]),s._v(">:   adrp   x8, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("229448")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebef8")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+8")]),s._v(">:   ldrsw  x8, [x8, #"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x154")]),s._v("]\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebefc")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+12")]),s._v(">:  ldr    x0, [x0, x8]\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf00")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+16")]),s._v(">:  ret    \n\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf04")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+20")]),s._v(">:  pacibsp                  ;如果越界，会执行到这里\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf08")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+24")]),s._v(">:  sub    sp, sp, #"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x20")]),s._v("             ; ="),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x20")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf0c")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+28")]),s._v(">:  stp    x29, x30, [sp, #"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x10")]),s._v("]\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf10")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+32")]),s._v(">:  add    x29, sp, #"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x10")]),s._v("            ; ="),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x10")]),s._v(" \n    .......                                      ;省略一些无用指令\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf68")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+120")]),s._v(">: mov    x4, #"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf6c")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+124")]),s._v(">: bl     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b3afb6a0")]),s._v("               ; objc_msgSend\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b47ebf70")]),s._v(" <"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("+128")]),s._v(">: bl     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b3ae3cc4")]),s._v("               ; objc_exception_throw ;最终执行到这，该函数就是异常的入口\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("关于函数"),n("code",[s._v("objc_exception_throw")]),s._v("实现，可在"),n("a",{attrs:{href:"https://github.com/opensource-apple/objc4/blob/master/runtime/objc-exception.mm",target:"_blank",rel:"noopener noreferrer"}},[s._v("Apple源码"),n("OutboundLink")],1),s._v("中找到，这里暂不深究。")])],1)},[],!1,null,null,null);t.default=e.exports}}]);