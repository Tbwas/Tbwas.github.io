(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{273:function(s,a,t){"use strict";t.r(a);var r=t(38),e=Object(r.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"常见汇编指令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见汇编指令","aria-hidden":"true"}},[s._v("#")]),s._v(" 常见汇编指令")]),s._v(" "),t("h2",{attrs:{id:"_0x0-引言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x0-引言","aria-hidden":"true"}},[s._v("#")]),s._v(" 0x0. 引言")]),s._v(" "),t("p",[s._v("好记性不如烂笔头，本文旨在记录一些日常工作中经常会遇到的汇编指令，并会不断更新。目前只包含"),t("router-link",{attrs:{to:"/assembly/assemblyinstructions.html#_0x1-arm64"}},[s._v("ARM")]),s._v("和"),t("router-link",{attrs:{to:"/assembly/assemblyinstructions.html#_0x2-at-t"}},[s._v("AT&T")]),s._v("两种格式，以"),t("router-link",{attrs:{to:"/assembly/assemblyinstructions.html#_0x1-arm64"}},[s._v("ARM64")]),s._v("为主。")],1),s._v(" "),t("h2",{attrs:{id:"_0x1-arm64"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x1-arm64","aria-hidden":"true"}},[s._v("#")]),s._v(" 0x1. ARM64")]),s._v(" "),t("h3",{attrs:{id:"mov"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mov","aria-hidden":"true"}},[s._v("#")]),s._v(" mov")]),s._v(" "),t("p",[s._v("传送指令：将立即数传送到寄存器/内存单元，或互传内存单元和寄存器两者中的数据。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("mov x0, #0x1")]),s._v(" / "),t("code",[s._v("mov $0x1, %rdi")]),s._v(" 将立即数0x1移动到寄存器x0/rdi中")]),s._v(" "),t("h3",{attrs:{id:"mvn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mvn","aria-hidden":"true"}},[s._v("#")]),s._v(" mvn")]),s._v(" "),t("p",[s._v("该指令与"),t("strong",[s._v("mov")]),s._v("唯一不同的是：需要对操作数进行按位取反。")]),s._v(" "),t("h3",{attrs:{id:"str"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#str","aria-hidden":"true"}},[s._v("#")]),s._v(" str")]),s._v(" "),t("p",[t("em",[s._v("store register")]),s._v(". 将寄存器中的数据存到内存单元中。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("str x0, [sp, #0x28]")]),s._v(" 将寄存器x0中的数据存到地址sp+0x28处")]),s._v(" "),t("h3",{attrs:{id:"stp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stp","aria-hidden":"true"}},[s._v("#")]),s._v(" stp")]),s._v(" "),t("p",[t("em",[s._v("store pair of registers")]),s._v(".")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("stp x29, x30, [sp, #0x70]")]),s._v(" 先将x29存到地址sp+0x70处，再将x30存到sp+0x78处 ("),t("strong",[s._v("Tip1")]),s._v(")。")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[t("strong",[s._v("Tip1:")]),s._v("\n64位下，寄存器大小为8bytes")])]),s._v(" "),t("h3",{attrs:{id:"ldr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ldr","aria-hidden":"true"}},[s._v("#")]),s._v(" ldr")]),s._v(" "),t("p",[t("em",[s._v("load register")]),s._v(". 从内存中读取数据，存到寄存器中。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("ldr x1, [sp, #0x30]")]),s._v(" 将内存地址sp+0x30处的数据加载到x1中。")]),s._v(" "),t("h3",{attrs:{id:"ldp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ldp","aria-hidden":"true"}},[s._v("#")]),s._v(" ldp")]),s._v(" "),t("p",[t("em",[s._v("load pair of registers.")])]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("ldp x29, x30, [sp, #0x70]")]),s._v(" 将内存地址sp+0x70处的数据加载到x29中，再将sp+0x78("),t("strong",[s._v("Tip1")]),s._v(")处的数据加载到x30中。")]),s._v(" "),t("h3",{attrs:{id:"b"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b","aria-hidden":"true"}},[s._v("#")]),s._v(" b")]),s._v(" "),t("p",[t("em",[s._v("branch")]),s._v(". 无条件跳转。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("b 0x1b6b79cf8")]),s._v("  跳转到"),t("code",[s._v("0x1b6b79cf8")]),s._v("处继续执行。")]),s._v(" "),t("h3",{attrs:{id:"bl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bl","aria-hidden":"true"}},[s._v("#")]),s._v(" bl")]),s._v(" "),t("p",[t("em",[s._v("branch with link")]),s._v(". 将下一条指令地址copy到lr中，然后跳转。由于保存了下一条指令地址(相对于pc)，所以可实现子程序的返回，而"),t("strong",[s._v("b")]),s._v("只能单纯的实现跳转，不能实现子程序返回。")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x102b7d8a4")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+160")]),s._v(">: bl   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x102bda450")]),s._v(" ; symbol stub for: objc_msgSend\n-> "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x102b7d8a8")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+164")]),s._v(">: adrp x0, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("当程序执行完"),t("strong",[s._v("bl")]),s._v("指令时，lr中的内容应该是是"),t("strong",[s._v("bl")]),s._v("下一条指令的地址，即"),t("code",[s._v("0x102b7d8a8")]),s._v("。通过控制台查看lr中的内容如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("fp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x000000016d2853c0\nlr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x0000000102b7d8a8  `-"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("AppDelegate application:didFinishLaunchingWithOptions:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" + "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("164")]),s._v(" at AppDelegate.m:41:5\nsp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x000000016d285350\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"cbz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cbz","aria-hidden":"true"}},[s._v("#")]),s._v(" cbz")]),s._v(" "),t("p",[t("em",[s._v("compare and branch on zero")]),s._v(". 比较操作数是否为0，若为0则跳转。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("cbz w24, 0x1b6b798f4")]),s._v(" 若w24 (x24寄存器低32位) 中的数据为0，则跳转到"),t("code",[s._v("0x1b6b798f4")]),s._v("处执行 ("),t("strong",[s._v("Note1")]),s._v(")。")]),s._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",[t("strong",[s._v("Note1:")]),s._v(" 跳转地址需要在"),t("strong",[s._v("cbz/cbnz")]),s._v("指令之后的4~130字节内。")])]),s._v(" "),t("h3",{attrs:{id:"cbnz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cbnz","aria-hidden":"true"}},[s._v("#")]),s._v(" cbnz")]),s._v(" "),t("p",[t("em",[s._v("compare and branch on non-zero")]),s._v(". 操作数不为0，则跳转。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("cbnz w27, 0x1b73c9e2c")]),s._v(" 若w27中的数据不为0，则跳转到"),t("code",[s._v("0x1b73c9e2c")]),s._v("处执行 ("),t("strong",[s._v("Note1")]),s._v(")。")]),s._v(" "),t("h3",{attrs:{id:"lsl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsl","aria-hidden":"true"}},[s._v("#")]),s._v(" lsl")]),s._v(" "),t("p",[t("em",[s._v("logical shift left")]),s._v(". 左移位。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("str x0, [x1, x2, lsl #2]")]),s._v(" 将x2中的值左移两位，再加上x1中的值，得到的结果为一个内存地址，最后将x0中的数据存到该内存中。")]),s._v(" "),t("h3",{attrs:{id:"lsr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsr","aria-hidden":"true"}},[s._v("#")]),s._v(" lsr")]),s._v(" "),t("p",[t("em",[s._v("logical shift right")]),s._v(". 右移位。")]),s._v(" "),t("h3",{attrs:{id:"cmp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cmp","aria-hidden":"true"}},[s._v("#")]),s._v(" cmp")]),s._v(" "),t("p",[t("em",[s._v("compare")]),s._v(". 比较两个数是否相等，首先将两个数相减，若差为0，则ZF ("),t("strong",[s._v("Tip2")]),s._v(") 为1，即两者相等。")]),s._v(" "),t("p",[t("code",[s._v("cmp w8, #0x3")]),s._v(" 通过判断w8中的值与0x3的差值是否为0，即ZF ("),t("strong",[s._v("Tip2")]),s._v(") 是否为1，来比较两者是否相等。")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[t("strong",[s._v("Tip2:")]),s._v("\nZF是零标志位寄存器。它记录相关指令执行后，其结果是否为0。若结果为0，则ZF=1；若结果为1，则ZF=0。")])]),s._v(" "),t("h3",{attrs:{id:"adrp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#adrp","aria-hidden":"true"}},[s._v("#")]),s._v(" adrp")]),s._v(" "),t("p",[t("em",[s._v("form pc-relative address to 4KB page")]),s._v(". 先将操作数左移12位，再将pc的低12位清零 (即3个十六进制位清零，得到一个页对齐地址)，最后两者相加，赋值给寄存器。")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b703f074")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+44")]),s._v(">:  adrp   x20, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("270332")]),s._v("\n-> "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1b703f078")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+48")]),s._v(">:  ldr    x0, [x20, #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7a0")]),s._v("]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("执行"),t("strong",[s._v("adrp")]),s._v("时，先将操作数270332 (十六进制为"),t("code",[s._v("0x41ffc")]),s._v(") 左移12位得到"),t("code",[s._v("0x41ffc000")]),s._v("，再将pc ("),t("code",[s._v("0x1b703f074")]),s._v(") 低12清零得到 "),t("code",[s._v("0x1b703f000")]),s._v("，最后两者相加得到"),t("code",[s._v("0x1f903b000")]),s._v("赋值给x20。通过控制台查看x20中的内容：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" x19 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x000000016ef25fb0\n x20 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x00000001f903b000  \n x21 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0x0000000281454380\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"adr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#adr","aria-hidden":"true"}},[s._v("#")]),s._v(" adr")]),s._v(" "),t("p",[t("em",[s._v("load a program-relative or register-relative address into a register")]),s._v(". 是一条伪指令，遇到该指令时汇编器会生成一条"),t("strong",[s._v("add")]),s._v("或"),t("strong",[s._v("sub")]),s._v("指令，来计算pc和操作数的和或者差，最后将得到的结果，放在寄存器中。")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("; 生成加法指令，即x0 = "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3b08")]),s._v(" + "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x2fc48")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022f3750")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3b08")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+108")]),s._v(">: adr x0, #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x2fc48")]),s._v("  ; _MergedGlobals + "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n-> "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3b0c")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+112")]),s._v(">: "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nop")]),s._v(" \n\n; 生成减法指令，即x2 = "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3b10")]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x390")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3780")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3b10")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+116")]),s._v(">: adr x2, #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("-0x390")]),s._v(" ; initializeAvailabilityCheck\n-> "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1022c3b14")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+120")]),s._v(">: "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nop")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"brk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#brk","aria-hidden":"true"}},[s._v("#")]),s._v(" brk")]),s._v(" "),t("p",[t("em",[s._v("breakpoint instruction.")]),s._v(" 用于生成断点指令异常。")]),s._v(" "),t("h3",{attrs:{id:"tbz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tbz","aria-hidden":"true"}},[s._v("#")]),s._v(" tbz")]),s._v(" "),t("p",[t("em",[s._v("test branch zero.")]),s._v(" 测试位为0，则跳转。")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("tbz w24, #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x6")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x19307005c")]),s._v(" ; 即w24第"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("位，若为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，则跳转到"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x19307005c")]),s._v("执行\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("w24 二级制数为：0b00000111000000000000100000000110")])]),s._v(" "),t("h3",{attrs:{id:"tbnz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tbnz","aria-hidden":"true"}},[s._v("#")]),s._v(" tbnz")]),s._v(" "),t("p",[t("em",[s._v("test branch no zero.")]),s._v(" 测试位不为0，则跳转。")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("tbnz w24, #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x6")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x19307005c")]),s._v(" ; 即w24第"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("位，若不为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，则跳转到"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x19307005c")]),s._v("执行\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("w24 二级制数为：0b00000111000000000000100000000110")])]),s._v(" "),t("h2",{attrs:{id:"_0x2-at-t"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x2-at-t","aria-hidden":"true"}},[s._v("#")]),s._v(" 0x2. AT&T")]),s._v(" "),t("h3",{attrs:{id:"test"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#test","aria-hidden":"true"}},[s._v("#")]),s._v(" test")]),s._v(" "),t("p",[s._v("将指令后的两个数进行按位与操作，其结果影响ZF。通常用来判断某个数是否为0/nil。")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("testq %rax, %rax ; 若%rax中的值为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，则ZF="),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("；反之，ZF="),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，q表示四字长\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"sete"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sete","aria-hidden":"true"}},[s._v("#")]),s._v(" sete")]),s._v(" "),t("p",[s._v("取ZF中的值，放入目标寄存器中。")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("testq %rax, %rax  ; 两个寄存器中的值按位与，结果影响ZF\nsete  %r12        ; 若%rax和%rbx相等，即ZF="),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("，则将%r12设为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("，反之设为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"setne"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setne","aria-hidden":"true"}},[s._v("#")]),s._v(" setne")]),s._v(" "),t("p",[s._v("取ZF中的值，然后取反，再放入目标寄存器中。")]),s._v(" "),t("p",[s._v("例如："),t("code",[s._v("setne %rax")]),s._v(" 若ZF=1，则%rax设为0；反之设为1")]),s._v(" "),t("h3",{attrs:{id:"je-jz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#je-jz","aria-hidden":"true"}},[s._v("#")]),s._v(" je / jz")]),s._v(" "),t("p",[s._v("je 和 jz这两条指令虽然名字不同，但做的事情都是一样的。即ZF=1，则跳转。")]),s._v(" "),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-wasm line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-wasm"}},[t("code",[s._v("libobjc.A.dylib`objc_retain:\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad350")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+0")]),s._v(">:  testq  %rdi, %rdi      ; 判断%rdi中的值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("第一个参数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("是否为nil\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad353")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+3")]),s._v(">:  je     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad371")]),s._v("  ; <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+33")]),s._v("> 若%rdi为nil，则跳转到"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad371")]),s._v("执行\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad355")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+5")]),s._v(">:  js     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad373")]),s._v("  ; <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+35")]),s._v(">\n->  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff50bad357")]),s._v(" <"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("+7")]),s._v(">:  movq   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%rdi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", %rax\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"jne-jnz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jne-jnz","aria-hidden":"true"}},[s._v("#")]),s._v(" jne / jnz")]),s._v(" "),t("p",[s._v("jne 和 jnz这两条指令做的事情也都是一样的。即ZF=0，则跳转。")]),s._v(" "),t("h3",{attrs:{id:"js"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#js","aria-hidden":"true"}},[s._v("#")]),s._v(" js")]),s._v(" "),t("p",[t("em",[s._v("jump if sign.")]),s._v("\n若结果为负数，即SF=1，则进行跳转。")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[s._v("SF: 符号标志位")]),s._v(" "),t("p",[s._v("它记录相关指令执行后，其结果是否为负。若结果为负，则SF=1；若为非负，则SF=0。")])]),s._v(" "),t("h3",{attrs:{id:"nop"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nop","aria-hidden":"true"}},[s._v("#")]),s._v(" nop")]),s._v(" "),t("p",[t("em",[s._v("no operation.")]),s._v(" 不执行任何操作。是一条单字节指令。\n"),t("code",[s._v("Opcode 90")])]),s._v(" "),t("h3",{attrs:{id:"ud2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ud2","aria-hidden":"true"}},[s._v("#")]),s._v(" ud2")]),s._v(" "),t("p",[t("em",[s._v("undefined instruction.")]),s._v("\n该指令用于生成一个无效操作码。当CPU试图执行无效或未定义的操作码时，将发生无效的"),t("a",{attrs:{href:"https://wiki.osdev.org/Exceptions",target:"_blank",rel:"noopener noreferrer"}},[s._v("操作码异常"),t("OutboundLink")],1),s._v("。"),t("code",[s._v("UD2")]),s._v("指令除了引发无效的操作码异常外，与"),t("code",[s._v("NOP")]),s._v("指令相同。")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[s._v("这里的异常是指CPU在发生“错误”时生成的。大多数情况下，有些异常并不是真正的错误，而是中断的一种类型。比如: Page Fault。异常分类如下：")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("Faults")]),s._v(" (错误)：这些错误可以被纠正，程序可以像什么都没有发生一样继续运行。")]),s._v(" "),t("li",[t("strong",[s._v("Traps")]),s._v(" (陷阱)：陷阱指令执行后会立即被报告。")]),s._v(" "),t("li",[t("strong",[s._v("Aborts")]),s._v(" (终止)：一些严重的不可恢复的错误。")])])]),s._v(" "),t("h3",{attrs:{id:"ret"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ret","aria-hidden":"true"}},[s._v("#")]),s._v(" ret")]),s._v(" "),t("p",[s._v("该指令用于子程序的返回。将栈顶数据(返回地址)弹出，赋值给 ip 寄存器，此时 sp 会增加一个内存单元大小，来释放栈空间。")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[s._v("栈底 "),t("strong",[s._v("[")]),s._v(" ... "),t("strong",[s._v("|")]),s._v(" ... , parameters, return address "),t("strong",[s._v("|")]),s._v(" previous frame pointer, "),t("code",[s._v("%rbp")]),s._v(" "),t("strong",[s._v("]")]),s._v(" 栈顶")]),s._v(" "),t("p",[t("code",[s._v("pop %rbp")]),s._v(" 👇"),t("br"),s._v("\n栈底 "),t("strong",[s._v("[")]),s._v(" ... "),t("strong",[s._v("|")]),s._v(" ... , parameters, return address "),t("strong",[s._v("]")]),s._v(" 栈顶")]),s._v(" "),t("p",[t("code",[s._v("ret")]),s._v(" 👇"),t("br"),s._v("\n栈底 "),t("strong",[s._v("[")]),s._v(" ... "),t("strong",[s._v("|")]),s._v(" ... , parameters "),t("strong",[s._v("]")]),s._v(" 栈顶")]),s._v(" "),t("p",[t("code",[s._v("caller release parameters")]),s._v(" 👇"),t("br"),s._v("\n栈底 "),t("strong",[s._v("[")]),s._v(" ... "),t("strong",[s._v("|")]),s._v(" ... "),t("strong",[s._v("]")]),s._v(" 栈顶")])])])},[],!1,null,null,null);a.default=e.exports}}]);